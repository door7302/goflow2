formatter:
  fields:
    - type
    - time_received
    - sequence_num
    - sampling_rate
    - flow_direction
    - sampler_address
    - time_flow_start
    - time_flow_end
    - time_flow_start_ms
    - time_flow_end_ms
    - bytes
    - packets
    - src_addr
    - dst_addr
    - etype
    - proto
    - src_port
    - dst_port
    - in_if
    - out_if
    - src_mac
    - dst_mac

    - custom_integer_1
    - custom_list_1
  key:
    - sampler_address
  render: # only for JSON/text and specific additional fields
    - name: src_mac
      render: mac
    - name: dst_mac
      render: mac
  rename: # only for JSON
    dst_port: test_port
  protobuf: # manual protobuf fields
    - name: custom_integer_1
      index: 555
      type: varint
    - name: custom_list_1
      index: 556
      type: varint
      array: true
# Decoder mappings
ipfix:
  mapping:
    - field: 7 # IPFIX_FIELD_sourceTransportPort
      destination: custom_integer_1
    - field: 11 # IPFIX_FIELD_destinationTransportPort
      destination: custom_integer_2
      # penprovided: false
      # pen: 0
    - field: 137
      destination: custom_list_1
      penprovided: true
      pen: 2636
netflowv9:
  mapping:
    - field: 7
      destination: CustomInteger1
    - field: 11
      destination: CustomInteger2
    - field: 34 # samplingInterval
      destination: SamplingRate
      endian: little
sflow:
  mapping:
    - layer: 4 # Layer 4: TCP or UDP
      offset: 0 # Source port
      length: 16 # 2 bytes
      destination: CustomInteger1
    - layer: 4
      offset: 16 # Destination port
      length: 16 # 2 bytes
      destination: CustomInteger2
